<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>@duper-js/wasm example</title>
  </head>
  <body>
    <script type="module">
      import { parse, stringify, DuperValue } from "@duper-js/wasm";

      // Parse some input
      const input = `
        Product({
          product_id: Uuid("1dd7b7aa-515e-405f-85a9-8ac812242609"),
          name: "Wireless Bluetooth Headphones",
          brand: "AudioTech",
          price: Decimal("129.99"),
          dimensions: (18.5, 15.2, 7.8),  // In centimeters
          weight: Kilograms(0.285),
          in_stock: true,
          specifications: {
            battery_life: Duration("30h"),
            noise_cancellation: true,
            connectivity: ["Bluetooth 5.0", "3.5mm Jack"],
          },
          image_thumbnail: Png(b"\\x89PNG\\r\\n\\x1a\\n\\x00\\x00\\x00\\rIHDR\\x00\\x00\\x00\\x64"),
          tags: ["electronics", "audio", "wireless"],
          release_date: Date("2023-11-15"),
          /* Warranty is optional */
          warranty_period: null,
          customer_ratings: {
            latest_review: r#"Absolutely ""astounding""!! ðŸ˜Ž"#,
            average: 4.5,
            count: 127,
          },
          created_at: DateTime("2023-11-17T21:50:43+00:00"),
        })
      `;
      const duper = parse(input);
      console.log(duper.identifier); // Product
      console.log(duper.inner.in_stock.type); // boolean

      // Convert to JSON
      console.log(JSON.stringify(duper));

      // Patch the Duper value and pretty-print it
      const newTags = [
        new DuperValue("music"),
        new DuperValue("hi-fi", "DeprecatedTag", "string"),
      ];
      duper.inner.tags.setValue(newTags, "tuple");
      duper.inner.image_thumbnail.identifier = null;
      duper.inner.weight.identifier = "Pounds";
      delete duper.inner.dimensions;
      duper.inner.test = new DuperValue({ foo: new DuperValue("bar") });
      console.log(stringify(duper, { indent: "  " }));
    </script>
  </body>
</html>
